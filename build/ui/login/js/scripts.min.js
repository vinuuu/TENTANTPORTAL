!function(){"use strict";function a(a,b,c,d){var e,f=this;f.init=function(){f.destWatch=c.$on("$destroy",f.destroy),f.model=e=a,e.showHideFlag="login",e.checkall=!1,e.oldPwd="",e.rdnmobCode=!1,f.formConfig=b,e.numFlag=e.upperFlag=e.lowerFlag=e.specialCharFlag=!1,d("username")&&d("password")&&(e.checkall=!0,f.model.username=d("username"),f.model.pwd=d("password"))},f.destroy=function(){f.destWatch(),f=void 0,c=void 0},f.rememberMe=function(){e.checkall?(d("username",f.model.username),d("password",f.model.pwd)):(d("username",""),d("password",""))},f.init()}angular.module("ui").controller("loginCtrl",a),a.$inject=["loginMdl","loginFormConfig","$scope","$remember"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){var h,i={},j=a("login").translate;i.formConfig=c,i.strUserName="",i.translateNames=function(a){return j(a)},i.toggleGridState=function(a){return a?(i.apiReady=!1,h.busy()):(i.apiReady=!0,h.off()),i},i.init=function(){return i.securityquestion="1",h=i.busyIndicator=f(),i},i.showhideDiv=function(a){i.showHideFlag=a,i.pwdSuccess=!1},c.setMethodsSrc(i);var k=[{securityQuesnID:"What is your pet's name?"},{securityQuesnID:"What is your mother's maiden name?"},{securityQuesnID:"What is your favorite color?"},{securityQuesnID:"What city were you born in?"},{securityQuesnID:"What town was your mother born in?"},{securityQuesnID:"What town was your father born in?"},{securityQuesnID:"Where did you meet your spouse?"},{securityQuesnID:"What was the make of your first car?"},{securityQuesnID:"What is the name of the street on which you grew up on?"}];c.setOptions("securityquestion",k),i.securityquestion="What is your pet's name?",i.pwdValidation=function(a){var b=/(?=.*\d)/,c=/(?=.*[A-Z])/,d=/(?=.*[a-z])/,e=/(?=.*[$@$!%*#?&])/;i.numFlag=void 0!==a&&b.test(a),i.upperFlag=void 0!==a&&c.test(a),i.lowerFlag=void 0!==a&&d.test(a),i.specialCharFlag=void 0!==a&&e.test(a)};var l=0;return i.submitLogin=function(){i.toggleGridState(!0);var a={request:{operation:{authentication:{login:{userid:i.username,password:i.pwd}},content:{function:{getTPAPISession:{}}}}}};i.oldPwd="",b.getLoginDetails(a).then(function(a){i.toggleGridState(!1),a.data&&(a.data.api?(i.oldPwd=i.pwd,l=0,sessionStorage.setItem("sessionID",a.data.api[0].sessionid),sessionStorage.setItem("userName",a.data.api[0].name),sessionStorage.setItem("companyName",a.data.api[0].companyname),g.setUsername(a.data.api[0].name),"T"===a.data.api[0].resetpassword?(i.showHideFlag="firstlogin",i.strUserName=i.username):d.go("home.dashbaord")):0===l?(i.pwdSuccess="failure",l++):1===l?(l++,i.pwdSuccess="warning"):i.pwdSuccess="locked")}).catch(function(a){i.toggleGridState(!1),i.pwdSuccess="failure"})},i.radiochange=function(a){alert(a)},i.resetpwdSubmit=function(a){i.toggleGridState(!0);var c={request:{operation:{content:{function:{getchangepwd:{pwdtype:"firstlogin"===i.showHideFlag?"login":"change",newpwd:i.pwd1,oldpwd:i.oldPwd,cnfrmpwd:i.pwd2,secquestion:i.securityquestion,secanswer:i.security_a}}}}}};b.changePwd(c).then(function(a){i.toggleGridState(!1),a.data&&"success"===a.data.api[0].status&&(e.removeNotifications(),e.success(a.data.api[0].message),"firstlogin"===i.showHideFlag&&d.go("home.dashbaord"))})},i.checkUserName=function(a){i.toggleGridState(!0);var c={request:{operation:{content:{function:{getforgotpwd:{type:"question",userid:i.u_e_id}}}}}};b.forgotPwd(c).then(function(b){i.toggleGridState(!1),b.data.api?"success"===b.data.api[0].status&&(i.securityQusn=b.data.api[0].secquestion,i.showHideFlag=a,i.strUserName=i.u_e_id,i.strErrUSernameFlag=!1):(i.strErrUSernameFlag=!0,i.elseErrMessage(b.data))}).catch(function(a){i.toggleGridState(!1),i.strErrUSernameFlag=!0,i.elseErrMessage(a.data)})},i.answerSecurityQusn=function(a){i.toggleGridState(!0);var c={request:{operation:{content:{function:{getforgotpwd:{type:"authcode",userid:i.strUserName,secquestion:i.securityQusn,secanswer:i.question1}}}}}};b.forgotPwd(c).then(function(b){i.toggleGridState(!1),b.data.api?"success"===b.data.api[0].status&&(i.showHideFlag=a,i.strErrQusn=!1,e.success(b.data.api[0].message)):(i.strErrQusn=!0,i.elseErrMessage(b.data))}).catch(function(a){i.toggleGridState(!1),i.strErrQusn=!0,i.elseErrMessage(a.data)})},i.checkSixDigitCode=function(a){i.toggleGridState(!0);var c={request:{operation:{content:{function:{getforgotpwd:{type:"validateauthcode",userid:i.strUserName,authcode:i.emailCode}}}}}};b.forgotPwd(c).then(function(b){i.toggleGridState(!1),b.data.api?"success"===b.data.api[0].status&&(i.showHideFlag=a,i.userToken=b.data.api[0].usertoken,i.strErrVerifyCode=!1):(i.strErrVerifyCode=!0,i.elseErrMessage(b.data))}).catch(function(a){i.toggleGridState(!1),i.strErrVerifyCode=!0,i.elseErrMessage(a.data)})},i.forgotpwdSubmit=function(){i.toggleGridState(!0);var a={request:{operation:{content:{function:{getforgotpwd:{type:"changepassword",userid:i.strUserName,authcode:i.emailCode,usertoken:i.userToken,newpwd:i.pwd1,cnfrmpwd:i.pwd2}}}}}};b.forgotPwd(a).then(function(a){i.toggleGridState(!1),a.data.api&&"success"===a.data.api[0].status&&(i.showHideFlag="login",i.pwdSuccess="success")}).catch(function(a){i.toggleGridState(!1),e.error(i.elseErrMessage(a.data))})},i.elseErrMessage=function(a){return i.elseStr=""!==a.errormessage[0].error[0].description[0].cdata?a.errormessage[0].error[0].description[0].cdata:a.errormessage[0].error[0].description2[0].cdata,i.elseStr},i.init()}angular.module("ui").factory("loginMdl",a),a.$inject=["appLangTranslate","loginSvc","loginFormConfig","$state","notificationService","rpBusyIndicatorModel","globalHeaderUsername"]}(),function(a,b){"use strict";function c(a,b,c){var d=a();return d.genRadio=function(a,c){c.forEach(function(c){d[c.id]=b({name:a})})},d.securityquestion=c({nameKey:"securityQuesnID",valueKey:"securityQuesnID"}),d.setOptions=function(a,b){if(!d[a])return d;d[a].setOptions(b)},d}a.module("ui").factory("loginFormConfig",["baseFormConfig","rpFormInputRadioConfig","rpFormSelectMenuConfig",c])}(angular),function(a,b){"use strict";function c(b,c,d){function e(b){for(var c=document.cookie.split("; "),d=0;d<c.length;d++){var e=c[d].split("=");if(b===e[0]){var f="";try{f=a.fromJson(e[1])}catch(a){f=unescape(e[1])}return f}}return null}return function(b,c){if(1===arguments.length)return e(b);var d=b+"=";if("object"==typeof c){var f="";if(d+="object"==typeof c.value?a.toJson(c.value)+";":c.value+";",c.expires){var g=new Date;g.setTime(g.getTime()+24*c.expires*60*60*1e3),f=g.toGMTString()}d+=c.session?"":"expires="+f+";",d+=c.path?"path="+c.path+";":"",d+=c.secure?"secure;":""}else d+=c+";";document.cookie=d}}a.module("ui").factory("$remember",[c])}(angular),function(){"use strict";function a(a){function c(c,d,e,f){if(f&&e[b]){var g=a(e[b]),h=function(a){var b=g(c),d=a===b;return f.$setValidity("match",d),a};f.$parsers.unshift(h),f.$formatters.push(h),e.$observe(b,function(){h(f.$viewValue)})}}return{link:c,restrict:"A",require:"?ngModel"}}var b="ngMatch";angular.module("ui").directive(b,a),a.$inject=["$parse"]}(),function(){"use strict";function a(a){return{getLoginDetails:function(b){return a.post("/api/login",b)},changePwd:function(b){return a.post("/api/changepwd",b)},forgotPwd:function(b){return a.post("/api/forgotPwd",b)}}}angular.module("ui").factory("loginSvc",a),a.$inject=["$http"]}();
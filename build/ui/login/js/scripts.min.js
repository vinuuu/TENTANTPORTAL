!function(){"use strict";function a(a,b,c,d){var e,f=this;f.init=function(){f.destWatch=c.$on("$destroy",f.destroy),f.model=e=a,e.showHideFlag="login",e.checkall=!1,e.oldPwd="",e.rdnmobCode=!1,f.formConfig=b,e.numFlag=e.upperFlag=e.lowerFlag=e.specialCharFlag=!1,d("username")&&d("password")&&(e.checkall=!0,f.model.username=d("username"),f.model.pwd=d("password"))},f.destroy=function(){f.destWatch(),f=void 0,c=void 0},f.rememberMe=function(){e.checkall?(d("username",f.model.username),d("password",f.model.pwd)):(d("username",""),d("password",""))},f.init()}angular.module("ui").controller("loginCtrl",a),a.$inject=["loginMdl","loginFormConfig","$scope","$remember"]}(),function(){"use strict";function a(a,b,c,d,e,f){var g,h={},i=a("login").translate;h.formConfig=c,h.strUserName="",h.translateNames=function(a){return i(a)},h.toggleGridState=function(a){return a?(h.apiReady=!1,g.busy()):(h.apiReady=!0,g.off()),h},h.init=function(){return h.securityquestion="1",g=h.busyIndicator=f(),h},h.showhideDiv=function(a){h.showHideFlag=a,h.pwdSuccess=!1},c.setMethodsSrc(h);var j=[{securityQuesnID:"What is your pet's name?"},{securityQuesnID:"What is your mother's maiden name?"},{securityQuesnID:"What is your favorite color?"},{securityQuesnID:"What city were you born in?"},{securityQuesnID:"What town was your mother born in?"},{securityQuesnID:"What town was your father born in?"},{securityQuesnID:"Where did you meet your spouse?"},{securityQuesnID:"What was the make of your first car?"},{securityQuesnID:"What is the name of the street on which you grew up on?"}];c.setOptions("securityquestion",j),h.securityquestion="What is your pet's name?",h.pwdValidation=function(a){var b=/(?=.*\d)/,c=/(?=.*[A-Z])/,d=/(?=.*[a-z])/,e=/(?=.*[$@$!%*#?&])/;h.numFlag=void 0!==a&&b.test(a),h.upperFlag=void 0!==a&&c.test(a),h.lowerFlag=void 0!==a&&d.test(a),h.specialCharFlag=void 0!==a&&e.test(a)};var k=0;return h.submitLogin=function(){h.toggleGridState(!0);var a={request:{operation:{authentication:{login:{userid:h.username,password:h.pwd}},content:{function:{getTPAPISession:{}}}}}};h.oldPwd="",b.getLoginDetails(a).then(function(a){h.toggleGridState(!1),a.data&&(a.data.api?(h.oldPwd=h.pwd,k=0,sessionStorage.setItem("sessionID",a.data.api[0].sessionid),sessionStorage.setItem("userName",a.data.api[0].name),sessionStorage.setItem("companyName",a.data.api[0].companyname),"T"===a.data.api[0].resetpassword?(h.showHideFlag="firstlogin",h.strUserName=h.username):d.go("home.dashbaord")):0===k?(h.pwdSuccess="failure",k++):1===k?(k++,h.pwdSuccess="warning"):h.pwdSuccess="locked")}).catch(function(a){h.toggleGridState(!1),h.pwdSuccess="failure"})},h.radiochange=function(a){alert(a)},h.resetpwdSubmit=function(a){h.toggleGridState(!0);var c={request:{operation:{content:{function:{getchangepwd:{pwdtype:"firstlogin"===h.showHideFlag?"login":"change",newpwd:h.pwd1,oldpwd:h.oldPwd,cnfrmpwd:h.pwd2,secquestion:h.securityquestion,secanswer:h.security_a}}}}}};b.changePwd(c).then(function(a){h.toggleGridState(!1),a.data&&"success"===a.data.api[0].status&&(e.removeNotifications(),e.success(a.data.api[0].message),"firstlogin"===h.showHideFlag&&d.go("home.dashbaord"))})},h.checkUserName=function(a){h.toggleGridState(!0);var c={request:{operation:{content:{function:{getforgotpwd:{type:"question",userid:h.u_e_id}}}}}};b.forgotPwd(c).then(function(b){h.toggleGridState(!1),b.data.api?"success"===b.data.api[0].status&&(h.securityQusn=b.data.api[0].secquestion,h.showHideFlag=a,h.strUserName=h.u_e_id,h.strErrUSernameFlag=!1):(h.strErrUSernameFlag=!0,h.elseErrMessage(b.data))}).catch(function(a){h.toggleGridState(!1),h.strErrUSernameFlag=!0,h.elseErrMessage(a.data)})},h.answerSecurityQusn=function(a){h.toggleGridState(!0);var c={request:{operation:{content:{function:{getforgotpwd:{type:"authcode",userid:h.strUserName,secquestion:h.securityQusn,secanswer:h.question1}}}}}};b.forgotPwd(c).then(function(b){h.toggleGridState(!1),b.data.api?"success"===b.data.api[0].status&&(h.showHideFlag=a,h.strErrQusn=!1,e.success(b.data.api[0].message)):(h.strErrQusn=!0,h.elseErrMessage(b.data))}).catch(function(a){h.toggleGridState(!1),h.strErrQusn=!0,h.elseErrMessage(a.data)})},h.checkSixDigitCode=function(a){h.toggleGridState(!0);var c={request:{operation:{content:{function:{getforgotpwd:{type:"validateauthcode",userid:h.strUserName,authcode:h.emailCode}}}}}};b.forgotPwd(c).then(function(b){h.toggleGridState(!1),b.data.api?"success"===b.data.api[0].status&&(h.showHideFlag=a,h.userToken=b.data.api[0].usertoken,h.strErrVerifyCode=!1):(h.strErrVerifyCode=!0,h.elseErrMessage(b.data))}).catch(function(a){h.toggleGridState(!1),h.strErrVerifyCode=!0,h.elseErrMessage(a.data)})},h.forgotpwdSubmit=function(){h.toggleGridState(!0);var a={request:{operation:{content:{function:{getforgotpwd:{type:"changepassword",userid:h.strUserName,authcode:h.emailCode,usertoken:h.userToken,newpwd:h.pwd1,cnfrmpwd:h.pwd2}}}}}};b.forgotPwd(a).then(function(a){h.toggleGridState(!1),a.data.api&&"success"===a.data.api[0].status&&(h.showHideFlag="login",h.pwdSuccess="success")}).catch(function(a){h.toggleGridState(!1),e.error(h.elseErrMessage(a.data))})},h.elseErrMessage=function(a){return h.elseStr=""!==a.errormessage[0].error[0].description[0].cdata?a.errormessage[0].error[0].description[0].cdata:a.errormessage[0].error[0].description2[0].cdata,h.elseStr},h.init()}angular.module("ui").factory("loginMdl",a),a.$inject=["appLangTranslate","loginSvc","loginFormConfig","$state","notificationService","rpBusyIndicatorModel"]}(),function(a,b){"use strict";function c(a,b,c){var d=a();return d.genRadio=function(a,c){c.forEach(function(c){d[c.id]=b({name:a})})},d.securityquestion=c({nameKey:"securityQuesnID",valueKey:"securityQuesnID"}),d.setOptions=function(a,b){if(!d[a])return d;d[a].setOptions(b)},d}a.module("ui").factory("loginFormConfig",["baseFormConfig","rpFormInputRadioConfig","rpFormSelectMenuConfig",c])}(angular),function(a,b){"use strict";function c(b,c,d){function e(b){for(var c=document.cookie.split("; "),d=0;d<c.length;d++){var e=c[d].split("=");if(b===e[0]){var f="";try{f=a.fromJson(e[1])}catch(a){f=unescape(e[1])}return f}}return null}return function(b,c){if(1===arguments.length)return e(b);var d=b+"=";if("object"==typeof c){var f="";if(d+="object"==typeof c.value?a.toJson(c.value)+";":c.value+";",c.expires){var g=new Date;g.setTime(g.getTime()+24*c.expires*60*60*1e3),f=g.toGMTString()}d+=c.session?"":"expires="+f+";",d+=c.path?"path="+c.path+";":"",d+=c.secure?"secure;":""}else d+=c+";";document.cookie=d}}a.module("ui").factory("$remember",[c])}(angular),function(){"use strict";function a(a){function c(c,d,e,f){if(f&&e[b]){var g=a(e[b]),h=function(a){var b=g(c),d=a===b;return f.$setValidity("match",d),a};f.$parsers.unshift(h),f.$formatters.push(h),e.$observe(b,function(){h(f.$viewValue)})}}return{link:c,restrict:"A",require:"?ngModel"}}var b="ngMatch";angular.module("ui").directive(b,a),a.$inject=["$parse"]}(),function(){"use strict";function a(a){return{getLoginDetails:function(b){return a.post("/api/login",b)},changePwd:function(b){return a.post("/api/changepwd",b)},forgotPwd:function(b){return a.post("/api/forgotPwd",b)}}}angular.module("ui").factory("loginSvc",a),a.$inject=["$http"]}();
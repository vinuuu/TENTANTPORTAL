!function(a,b){"use strict";function c(a,c,d,e,f){var g,h=this,i=f;a.response={},h.init=function(){h.destWatch=a.$on("$destroy",h.destroy),h.model=g=e;g.response.custData;h.content=i,h.vaaaaa="hhhhhh"},h.destroy=function(){h.destWatch(),h=b,a=b},h.init()}a.module("ui").controller("accountsCtrl",["$scope","$http","notificationService","accountsMdl","accountsContent",c])}(angular),function(){"use strict";function a(a,b,c,d,e,f,g,h,i,j,k,l){var m,n={},o=d(),p=j(),q=e(),r={currentPage:0,pagesPerGroup:5,recordsPerPage:6,currentPageGroup:0};return n.response={},n.init=function(){m=n.busyIndicator=h(),n.leaseArray=[],b.setMethodsSrc(n),n.formConfig=b;var a=[{accountHisrotyName:"Current Month",accountHisrotyNameID:k().format("YYYY MM DD")},{accountHisrotyName:"last 3 Month",accountHisrotyNameID:k().subtract(3,"month").format("YYYY MM DD")},{accountHisrotyName:"last 6 Month",accountHisrotyNameID:k().subtract(6,"month").format("YYYY MM DD")}];return b.setOptions("accountHistory",a),n.accountHistoryType=k().format("YYYY MM DD"),n.grid=o,q.watch(o),o.setConfig(c),p.setGrid(o),p.setConfig(r),n.gridPagination=p,o.formConfig=b,n.bindLeaseIDToDDl(),n},n.onaccountHistorySelection=function(a){n.getCustData({leaseid:n.leaseid,asofDate:k(a)})},n.bindtenantdata=function(a){n.list=a.records},n.onleaseDataSelection=function(a){n.getCustData({leaseid:a,asofDate:k(n.accountHistoryType)})},n.bindLeaseIDToDDl=function(){n.toggleGridState(!0);var a={request:{operation:{content:{function:{readByQuery:{object:"leaseoccupancy",fields:"",query:"",returnFormat:"json"}}}}}};f.getLeaseList(a).catch(g.error).then(function(a){a.data.forEach(function(a){n.leaseArray.push({accountHisrotyNameID:a.LEASEID,accountHisrotyName:"LeaseID :"+a.LEASEID})}),b.setOptions("leaseData",n.leaseArray),n.accountHistory=n.leaseArray[0].accountHisrotyNameID,n.getCustData({leaseid:n.accountHistory,asofDate:k(n.accountHistoryType)}),n.toggleGridState(!1)})},n.getCustData=function(b){n.toggleGridState(!0);var c={request:{operation:{content:{function:{getTenantBalance:{leaseid:b.leaseid,asofdate:{year:b.asofDate.year(),month:b.asofDate.month()+1,day:"01"}}}}}}},d={request:{operation:{content:{function:{readByQuery:{object:"pminvoice",fields:"",query:"(LEASEID = '"+b.leaseid+"')",returnFormat:"json"}}}}}};l.all([a.getAccountsInfo(c),i.getInvoiceList(d)]).catch(g.error).then(function(a){n.toggleGridState(!1),n.custData=a[0].data.api[0],n.custData.duedate=new Date(n.custData.duedate),p.setData(a[1].data).goToPage({number:0})})},n.toggleGridState=function(a){return a?(n.apiReady=!1,m.busy()):(n.apiReady=!0,m.off()),n},n.init()}angular.module("ui").factory("accountsMdl",a),a.$inject=["accountsSvc","accountsConfig","sampleGrid1Config","rpGridModel","rpGridTransform","dashboardSvc","baseModel","rpBusyIndicatorModel","invoiceSvc","rpGridPaginationModel","moment","$q"]}(angular),function(a){"use strict";function b(a,b){var c=a();return c.accountHistory=b({nameKey:"accountHisrotyName",valueKey:"accountHisrotyNameID",onChange:c.getMethod("onaccountHistorySelection")}),c.leaseData=b({nameKey:"accountHisrotyName",valueKey:"accountHisrotyNameID",onChange:c.getMethod("onleaseDataSelection")}),c.setOptions=function(a,b){if(!c[a])return c;c[a].setOptions(b)},c}a.module("ui").factory("accountsConfig",["baseFormConfig","rpFormSelectMenuConfig",b])}(angular),function(a){"use strict";function b(a){var b=a();return b.get=function(){return[{key:"Date"},{key:"RECORDNO"},{key:"LEASEID"},{key:"UNITID"},{key:"TOTALENTERED",type:"currency"},{key:"STATE",type:"custom",templateUrl:"app/templates/labelStatus.html"},{key:"datePaid"},{key:"file",type:"custom"}]},b.getHeaders=function(){return[[{key:"Date",text:"Date"},{key:"RECORDNO",text:"Invoice"},{key:"LEASEID",text:"Lease ID"},{key:"UNITID",text:"Unit ID"},{key:"TOTALENTERED",text:"Amount"},{key:"STATE",text:"Status"},{key:"datePaid",text:"datePaid"},{key:"file",text:"file"}]]},b.getFilters=function(){return[{key:"Date",type:"text",filterDelay:0,placeholder:"Filter by Date"},{key:"RECORDNO",type:"text",filterDelay:0,placeholder:"Filter by Invoice"},{key:"LEASEID",type:"text",filterDelay:0,placeholder:"Lease ID"},{key:"UNITID",type:"text",filterDelay:0,placeholder:"Filter by Unit ID"},{key:"TOTALENTERED",type:"text",filterDelay:0,placeholder:"Filter by Amount"},{key:"STATE",type:"text",filterDelay:0,placeholder:"Filter by STATE"},{key:"datePaid",type:"text",filterDelay:0,placeholder:"Filter by datePaid"}]},b}a.module("ui").factory("sampleGrid1Config",["rpGridConfig",b])}(angular),function(a){"use strict";function b(a){var b=a("Accounts").translate;return{pageHeading:b("accountsHeader"),pageComingSoon:b("comingsoon")}}a.module("ui").factory("accountsContent",["appLangTranslate",b])}(angular),function(){"use strict";function a(a){return{getAccountsInfo:function(b){return a.post("/api/accounts",b)}}}angular.module("ui").factory("accountsSvc",a),a.$inject=["$http"]}();
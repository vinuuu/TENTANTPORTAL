angular.module("rpSessionTimeout",[]),function(e){"use strict";function i(e){e.init()}e.module("rpSessionTimeout").run(["sessionTimeout",i])}(angular),function(e){"use strict";function i(e,i){function t(t,n,s){var o={};o.init=function(){o.timer=e,t.sessionTimeout=o},o.extendSession=function(){i.extendSession()},o.init()}return{link:t,restrict:"C"}}e.module("rpSessionTimeout").directive("rpSessionTimeoutModal",["sessionTimer","sessionTimeout",i])}(angular),function(e){"use strict";function i(i,t,n,s,o,a){var u=this;u.ready=!1,u.win=e.element(t),u.init=function(){u.ready||(u.modal=i({show:!1,backdrop:"static",animation:"am-fade-and-slide-down",templateUrl:"realpage/session-timeout/templates/session-timeout.html"}),u.ready=!0,u.extendSession(),o.onEnd(u.eraseAuth),s.subscribe("update",u.setModalTimeout))},u.showModal=function(){u.modal.show(),o.start(300)},u.hideModal=function(){return u.modal.hide(),o.reset(),u},u.extendSession=function(){u.win.off("mousemove.sessionTimeout"),a.reauthenticate().then(a.storeReauth),u.hideModal().setModalTimeout()},u.setModalTimeout=function(){n.cancel(u.timer1),n.cancel(u.timer2),u.timer1=n(u.showModal,a.getExpTime()-1e4),u.timer2=n(u.watchUser,a.getExpTime()-2e4)},u.watchUser=function(){u.win.on("mousemove.sessionTimeout",u.extendSession)},u.eraseAuth=function(){a.erase().then(u.signout)},u.signout=function(){t.location.href="/ui/signin/#/"}}e.module("rpSessionTimeout").service("sessionTimeout",["$modal","$window","$timeout","sessionInfo","sessionTimer","authentication",i])}(angular),function(e){"use strict";function i(i){var t=this;t.data={min:"",sec:""},t.timer={min:"",sec:""},t.onEndCallback=e.noop,t.start=function(e){t.timer.sec=e%60,t.timer.min=Math.floor(e/60),t.countdown(),t.interval=i(t.countdown,1e3)},t.onEnd=function(e){t.onEndCallback=e},t.countdown=function(){var e="",i="";-1==--t.timer.sec&&(t.timer.sec=59,t.timer.min--),t.timer.min<10&&(e="0"),t.timer.sec<10&&(i="0"),t.data.min=e+t.timer.min,t.data.sec=i+t.timer.sec,0===t.timer.min&&0===t.timer.sec&&(t.reset(),t.onEndCallback())},t.reset=function(){i.cancel(t.interval)}}e.module("rpSessionTimeout").service("sessionTimer",["$interval",i])}(angular),angular.module("rpSessionTimeout").run(["$templateCache",function(e){e.put("realpage/session-timeout/templates/session-timeout.html",'<div class="modal rp-session-timeout-modal am-fade-and-slide-top" tabindex="-1" role="dialog"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" ng-click="sessionTimeout.extendSession()">Ã—</button><h4 class="modal-title">Are You Still There?</h4></div><div class="modal-body"><p>For security reasons, your session will end soon due to inactivity.</p><p>Your session will end in <strong>{{sessionTimeout.timer.data.min}} min(s) {{sessionTimeout.timer.data.sec}} sec(s)</strong>.</p></div><div class="modal-footer"><button type="button" class="btn btn-primary" ng-click="sessionTimeout.extendSession()">Extend Session</button></div></div></div></div>')}]);
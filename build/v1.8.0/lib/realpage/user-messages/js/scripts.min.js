angular.module("rpUserMessages",[]),function(e){"use strict";var s,t;t="templates/realpage/common/user-messages/user-messages.html",s="<div class='user-messages' ng-class='model.state'><div class='message {{::msg.data.statusType}}' ng-repeat='msg in model.messages'><div class='message-icon-{{::msg.data.statusType}}'></div><div class='heading'><div class='title'>{{::msg.translate('title', msg.data)}}</div><div class='date'>{{::msg.data.msgStartDate}}</div></div><div class='message-content' toggle-message-content='msg.data'><any ng-bind-html='msg.translate(\"actionValue\", msg.data) | htmlUnsafe'></any></div><div class='action' ng-if='msg.data.actionType'><div ng-switch='msg.data.actionType'><div ng-switch-when='accept'><input type='checkbox' id='checkbox{{$index}}' class='rp-form-checkbox' ng-model='msg.data.acceptBit' ng-change='model.updateActivityLog(msg.data.msgID)'/><label class='checkbox-label' for='checkbox{{$index}}' >{{::msg.translate('actionText', msg.data)}}</label></div><div ng-switch-when='link'><a href='{{::msg.data.actionUrl}}'>{{::msg.translate('actionText', msg.data)}}</a></div></div></div></div></div>",e.module("rpUserMessages").run(["$templateCache",function(e){e.put(t,s)}])}(angular),function(e){"use strict";e.module("rpUserMessages").factory("userMessages",["$resource","rpCookie",function(e,s){var t=s.read("LANG")||"en-us";return{get:e("/api/core/common/omsmessage/user/messages/"+t).get,recordActivity:function(){var s;return s={recordActivity:{method:"POST",params:{msgID:"@msgID",msgulActionID:2}}},e("/api/core/common/OMSMessage/UserLog/:msgID/:msgulActionID",{},s).recordActivity}()}}])}(angular),function(e){"use strict";e.module("rpUserMessages").factory("userMessagesModel",["userMessages","userMessageModel","rpSessionStorage",function(e,s,t){var a={"critical-messages":!1},n={messageID:0},i={state:a,messages:[],changePasswordUrl:"/ui/signin/#/change-password"};return i.text={viewAllMessages:"view all messages"},i.load=function(){return e.get(i.update)},i.update=function(e){return e&&e.omsMessageUserList&&e.omsMessageUserList.forEach&&e.omsMessageUserList.forEach(function(e){var t=i.updateMsgData(e);i.messages.push(s().init(t))}),i},i.updateMsgData=function(e){return"change-password"===e.actionName&&(e.actionUrl=i.changePasswordUrl,n.messageID=e.msgID,t.set("changePasswordMessageData",n)),e},i.showAllMessages=function(){return a["critical-messages"]=!1,i},i.showCriticalMessages=function(){return a["critical-messages"]=!0,i},i.getMessagesCount=function(){return i.messages.length},i.hasMessages=function(){return i.messages.length>0},i.getCriticalMessagesCount=function(){var e=0;return i.messages.forEach(function(s){s.isCritical()&&e++}),e},i.hasCriticalMessages=function(){return i.getCriticalMessagesCount()>0},i.reset=function(){i.messages.flush(),a["critical-messages"]=!1},i.updateActivityLog=function(s){var t={msgID:s,msgulActionID:2};e.recordActivity(t,{})},i}])}(angular),function(e){"use strict";e.module("rpUserMessages").factory("userMessageModel",["appLangTranslate","rpSessionStorage",function(e,s){return function(){var t={};return t.data={},t.translate=e("userMessages").translate,t.init=function(e){return t.data=e,t.updateChangePassword(e),t},t.isCritical=function(){return"critical"===t.data.statusType},t.updateChangePassword=function(e){if("change-password"==e.actionName){var t={};t.messageID=t.msgID,e.actionUrl="/ui/signin/#/change-password",s.set("changePasswordMessageData",t)}return e},t.updateMessageData=function(e){var s=e;return e&&(e=t.translate("messageData",e)),s},t}}])}(angular),function(e,s){"use strict";e.module("rpUserMessages").directive("userMessages",["userMessagesModel",function(e){return{scope:{},link:function(t,a,n){var i,r={};r.init=function(){t.dir=r,e.load(),t.model=e,i=t.$on("$destroy",r.destroy)},r.showAllMessages=function(){e.showAllMessages()},r.destroy=function(){i(),e.reset(),t.model=s},r.init()},restrict:"E",replace:!0,templateUrl:"templates/realpage/common/user-messages/user-messages.html"}}])}(angular),function(e){"use strict";e.module("rpUserMessages").directive("toggleMessageContent",["$compile","appLangTranslate","timeout","deviceInfoSvc",function(s,t,a,n){var i=1;return{link:function(r,g,o){var c={isOpen:!1,toggleText:"readMore",instName:"toggleMessageContent"+i++,translate:t("common").translate,click:n.clickEvent("toggleMessageContent")};c.init=function(){r[c.instName]=c,c.watch=r.$watch(c.hasHeight,c.setup)},c.getToggleElem=function(){var t='<span class="toggle-message-content">{{'+c.instName+".translate("+c.instName+".toggleText)}}</span>",a=e.element(t);return s(a)(r)},c.setup=function(e){if(e&&c.watch(),c.enabled()){c.closedHeight=65,c.openHeight=g.height();var s=c.getToggleElem();g.append(s).css("height",c.closedHeight).addClass("toggle-enabled closed"),s.on(c.click,c.onClick)}},c.onClick=function(){r.$apply(c.toggleContent)},c.toggleContent=function(){c.isOpen?(c.isOpen=!1,g.addClass("closed"),c.openHeight=g.height(),g.height(c.openHeight),g.height(c.closedHeight),c.toggleText="readMore"):(c.isOpen=!0,g.height(c.openHeight),g.removeClass("closed"),a(c.setAutoHeight,210),c.toggleText="readLess")},c.setAutoHeight=function(){g.height("")},c.getData=function(){return r.$eval(o.toggleMessageContent)},c.hasHeight=function(){return g.outerHeight()>75},c.enabled=function(){return!c.getData().showFullMessage&&c.hasHeight()},c.init()},restrict:"A"}}])}(angular);
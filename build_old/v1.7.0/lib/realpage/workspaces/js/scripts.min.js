angular.module("rpWorkspaces",[]),angular.module("rpWorkspaces").run(["$templateCache",function(e){e.put("realpage/workspaces/templates/workspaces.html",'<div class="rp-workspaces scroll-workspace">\x3c!-- <rp-busy-indicator model="busyModel">\n    </rp-busy-indicator>\n    --\x3e<div class="rp-workspaces-list" ng-class="listCtrl.list.state"><rp-toggle model="listCtrl.list.state.active" class="rp-workspaces-list-toggle header-text ft-medium ft-s-18 ft-track-20" options="{\n                bodyToggle: true,\n                activeText: \'Workspaces\',\n                defaultText: \'Workspaces\',\n                defaultIconClass: \'rp-icon-angle-up\',\n                activeIconClass: \'rp-icon-angle-down\'\n            }"></rp-toggle><ul rp-stop-event="click" class="rp-workspaces-list-wrap dropdown-menu dropdown-menu-width ft-form"><li class="rp-workspaces-list-item" ng-if="!workspace.isPlaceholder()" ng-repeat="workspace in model.list track by workspace.id"><label for="{{::workspace.id}}" class="rp-workspaces-list-item-label md-check dark-bluebox">{{::workspace.getTitle()}} <input type="checkbox" id="{{::workspace.id}}" ng-true-value="true" ng-false-value="false" class="ui-check" ng-change="model.save()" ng-model="workspace.data().isActive"> <i class="primary"></i></label></li></ul></div><rp-daterangepicker ng-if="model.isDateSensitive()" rp-model="workspaces.dateRange" class="inline workspaces-date-range" config="workspaces.daterangepickerConfig"></rp-daterangepicker><div class="rp-workspaces-border-b b-b b-b-neutral-06"></div><span class="scroll-left rp-icon-angle-right text-neutral-04" ng-click="workspaceScroll.left()" ng-class="workspaceScroll.state.scrollLeft"></span> <span class="scroll-right rp-icon-angle-left text-neutral-04" ng-click="workspaceScroll.right()" ng-class="workspaceScroll.state.scrollRight"></span><div class="rp-workspaces-screen-wrap"><div class="rp-workspaces-screen rp-draggable-wrap"><div class="rp-workspaces-slider"><div ng-show="workspace.isActive()" rp-droppable="{{::workspace.id}}" rp-draggable="{{::workspace.id}}" rp-drag="workspaces.drag(workspace)" rp-drag-enabled="workspace.allowDrag" rp-drag-end="workspaces.endDrag(workspace)" rp-drag-start="workspaces.startDrag(workspace)" class="rp-workspace {{workspace.data().className}}" ng-repeat="workspace in model.list track by workspace.id"><div class="rp-workspaces-box"><div class="box-workspaces-header b-b b-b-neutral-04"><h3 class="text-primary ft-medium ft-s-16 ft-track-5 text-u-c">{{::workspace.getTitle()}}</h3></div><ul ng-mouseout="workspace.enableDrag()" ng-mouseover="workspace.disableDrag()" rp-touchend="workspace.enableDrag()" rp-touchstart="workspace.disableDrag()" class="metrics details-{{workspace.metricCount()}}"><li ng-click="workspace.goTo(detail)" ng-repeat="detail in workspace.data().details" class="{{::workspace.getListClass()}} {{$even ? \' pad-left\' : \' pad-right\'}}"><span class="metric text-{{detail.status}}">{{::detail.metric}} </span><span class="desc" title="{{::workspace.getDesc(detail)}}">{{::workspace.getDesc(detail)}}</span></li></ul></div></div></div></div></div></div>')}]),function(e){"use strict";function t(t){var r={};return r.config={dateSensitive:!0},r.get=e.noop,r.save=e.noop,r.setConfig=function(t){return e.extend(r.config,t),r.configGet().configSave(),r},r.configGet=function(){var e,a,s;return e=r.config.dateSensitive,a=r.config.getUrl+(e?"/:startDate/:endDate":""),s={endDate:14452308e5,startDate:14462676e5},r.get=t(a,e?s:{}).get,r},r.configSave=function(){var e,a;return a={save:{method:"PUT"}},e=r.config.saveUrl,r.save=t(e,{},a).save,r},r.isDateSensitive=function(){return r.config.dateSensitive},r}e.module("rpWorkspaces").factory("workspaces",["$resource",t])}(angular),function(e){"use strict";function t(e){var t={};return t.links={},t.setLinks=function(e){e&&(t.links=e)},t.goTo=function(r){t.links[r]&&(e.location.href=t.links[r])},t}e.module("rpWorkspaces").factory("workspacesLinks",["$window",t])}(angular),function(e){"use strict";function t(t,r,a,s){var n={};return n.config={links:{},getUrl:"",translate:{},appName:"lrc",dateSensitive:!0,saveUrl:"/api/core/common/workspace"},n.setConfig=function(o){e.extend(n.config,o),t.setConfig(n.config),r.setLinks(n.config.links),a.setAppName(n.config.appName),s.set(o.translator)},n}e.module("rpWorkspaces").factory("workspacesConfig",["workspaces","workspacesLinks","workspacesDateRange","workspaceTranslate",t])}(angular),function(e){"use strict";function t(e){var t={};return t.events=e(),t.state={scrollLeft:{hide:!1},scrollRight:{hide:!0}},t.getState=function(){return t.state},t.reset=function(){return t.state.scrollLeft.hide=!1,t.state.scrollRight.hide=!0,t},t.publish=function(e){return t.events.publish(e),t},t.subscribe=function(e){return t.events.subscribe(e),t},t.hideScrollLeft=function(e){return t.state.scrollLeft.hide=e,t},t.hideScrollRight=function(e){return t.state.scrollRight.hide=e,t},t}e.module("rpWorkspaces").factory("workspaceScrollModel",["eventStream",t])}(angular),function(e){"use strict";function t(e,t,r){var a=1;return function(s){var n={};return n.id=s||"workspace"+a++,n.allowDrag=!0,n._data={details:[],isActive:!1},n.data=function(e){return e?(n._data=e,n):n._data},n.getID=function(){return n.id},n.enableDrag=function(){n.allowDrag=!0},n.disableDrag=function(){n.allowDrag=!1},n.state=function(){return{active:n._data.isActive}},n.isActive=function(){return n._data.isActive},n.isPlaceholder=function(){return"placeholder"==n._data.className},n.is=function(e){return n.id===e.id},n.metricCount=function(){return n._data.details.length},n.getTitle=function(){return r.translate(n._data.guid+"-title")},n.setDirty=function(){return n._data.dirtyBit=!0,n},n.goTo=function(t){var a="";a=r.translate(t.guid+"-desc"),n.setCookie(a),e.goTo(n._data.guid)},n.setCookie=function(e){t.create("WorkspaceLink",e,1)},n.setSequence=function(e){return n._data.sequence=e,n},n.getDesc=function(e){var t,a;return a=r.translate(e.guid+"-desc"),t=""===e.description?"":": "+e.description,t=a+t},n.getListClass=function(){var e="";switch(n.metricCount()){case 1:e="col-xs-12";break;case 2:e="col-xs-6";break;case 3:e="col-xs-12";break;case 4:case 5:case 6:default:e="col-xs-6"}return e},n}}e.module("rpWorkspaces").factory("workspaceModel",["workspacesLinks","rpCookie","workspaceTranslate",t])}(angular),function(e){"use strict";function t(e,t){var r={};return r.id="workspacesDateRange",r.setAppName=function(e){return r.id=e+"WorkspacesDateRange",r},r.get=function(a){var s={};if(t.has(r.id)){var n=t.get(r.id);s.endDate=e(n.endDate,"x"),s.startDate=e(n.startDate,"x")}else s.endDate=e().endOf("month"),s.startDate=e().startOf("day");return a&&(s={endDate:s.endDate.format(a),startDate:s.startDate.format(a)}),s},r.set=function(e){t.set(r.id,e)},r}e.module("rpWorkspaces").factory("workspacesDateRange",["moment","rpSessionStorage",t])}(angular),function(e,t){"use strict";function r(e,r){var a={};return a.list=[],a._placeholderIndex=t,a._placeholder=r("placeholder").data({title:"",details:[],isActive:!0,className:"placeholder"}),a.isDateSensitive=function(){return e.isDateSensitive()},a.load=function(t){return a.flush(),t?e.get(t,a.update).$promise:e.get(a.update).$promise},a.update=function(e){e.records=e.records||[],e.records.forEach(a.addToList)},a.addToList=function(e){var t=r().data(e);a.list.push(t)},a.getIndex=function(e){var t;return a.list.forEach(function(r,a){e.is(r)&&(t=a)}),t},a.insertWorkspaceAt=function(e,t){return a.list.insertAt(e,t),a},a.removeWorkspace=function(e){return a.list=a.list.filter(function(t){return!e.is(t)}),a},a.eachWorkspace=function(e){return a.list.forEach(e),a},a.insertPlaceholderAt=function(e){a._placeholderIndex=e,a.insertWorkspaceAt(e,a._placeholder)},a.removePlaceholder=function(){return a.removeWorkspace(a._placeholder),a},a.replacePlaceholderWith=function(e){var t=a._placeholderIndex,r=a.getIndex(e)<t?t-1:t;return a.removeWorkspace(e).removePlaceholder().insertWorkspaceAt(r,e),a},a.flush=function(){a.list.flush()},a.updatedList=function(){var e=[];return a.list.forEach(function(t,r){t.setSequence(r+1).setDirty(),e.push(t.data())}),{workspaceList:e}},a.save=function(t){var r=a.updatedList();return e.save(t,r).$promise},a}e.module("rpWorkspaces").factory("workspacesModel",["workspaces","workspaceModel",r])}(angular),function(e){"use strict";function t(){var t={translator:{translate:e.noop}};return t.set=function(e){t.translator=e},t.translate=function(e){return t.translator.translate(e)},t}e.module("rpWorkspaces").factory("workspaceTranslate",[t])}(angular),function(e,t){"use strict";function r(e,r,a,s,n,o,c,i){var l=this;l.busy=!1,l.activeIndex=t,l.activeWorkspace=t,l.init=function(){e.model=a,e.busyModel=c(),a.isDateSensitive()&&l.initDaterangePicker(),r.isReady()&&l.updateModel(),e.$on("$destroy",l.destroy),l.sessionWatch=r.subscribe("update",l.updateModel)},l.initDaterangePicker=function(){l.dateRange=s.get(),l.daterangepickerConfig=i({onChange:l.onDateRangeChange})},l.onDateRangeChange=function(e){s.set(e),l.updateModel()},l.updateModel=function(){if(!l.busy){l.busy=!0;var t=s.get("x");e.busyModel.busy(),a.isDateSensitive()?a.load(t).then(l.afterUpdate):a.load().then(l.afterUpdate)}},l.afterUpdate=function(){e.busyModel.off(),l.busy=!1},l.startDrag=function(e){l.activeIndex=a.getIndex(e),a.insertPlaceholderAt(l.activeIndex)},l.drag=function(e){l.activeWorkspace=e,a.eachWorkspace(l.movePlaceholder)},l.movePlaceholder=function(e,t){if(!e.is(l.activeWorkspace)&&!e.isPlaceholder()){var r=l.activeWorkspace.getID(),s=n(r).dragPoint();o(e.getID()).contains(s)&&t!=l.activeIndex&&(l.activeIndex=t,a.removePlaceholder().insertPlaceholderAt(t))}},l.endDrag=function(e){a.replacePlaceholderWith(e).save()},l.destroy=function(){a.flush(),l.sessionWatch()},l.init()}e.module("rpWorkspaces").controller("WorkspacesCtrl",["$scope","sessionInfo","workspacesModel","workspacesDateRange","rpDraggableSvc","rpDroppableSvc","rpBusyIndicatorModel","rpDaterangepickerConfig",r])}(angular),function(e){"use strict";function t(e,t){function r(r,a,s){var n,o={};o.init=function(){r.workspacesScreen=o,e.reset().subscribe(o.eventHandler),a.on("scroll",o.onScroll)},o.onScroll=function(){t.cancel(n),n=t(o.updateControls,200)},o.updateControls=function(){var t=o.getStops(),r=o.getScroll();e.hideScrollRight(0===r),e.hideScrollLeft(r>=t[t.length-1]-2)},o.eventHandler=function(e){o[e]()},o.sliderWidth=function(){return a.children(".rp-workspaces-slider").outerWidth()},o.slideWidth=function(){return a.children(".rp-workspaces-slider").children(".rp-workspace").outerWidth(!0)},o.screenWidth=function(){return a.width()},o.getScroll=function(){return a.scrollLeft()},o.getStep=function(){return o.slideWidth()*Math.floor(o.screenWidth()/o.slideWidth())},o.getStops=function(){for(var e=0,t=[],r=o.getStep(),a=o.sliderWidth()-o.screenWidth();e<a;)t.push(e),(e+=r)>a&&(e=a,t.push(e));return t},o.scrollLeft=function(){var e,t=o.getStops(),r=o.getScroll();t.forEach(function(t){!e&&t>r&&(e=t)}),o.animate(e)},o.scrollRight=function(){var e,t=o.getScroll();o.getStops().reverse().forEach(function(r){!e&&r<t&&(e=r)}),o.animate(e)},o.animate=function(e){a.animate({scrollLeft:e},200)},o.init()}return{link:r,restrict:"C"}}e.module("rpWorkspaces").directive("rpWorkspacesScreen",["workspaceScrollModel","timeout",t])}(angular),function(e){"use strict";function t(e){function t(t,r,a){var s={};s.state=e.getState(),s.init=function(){t.workspaceScroll=s},s.left=function(){e.publish("scrollLeft")},s.right=function(){e.publish("scrollRight")},s.init()}return{link:t,restrict:"C"}}e.module("rpWorkspaces").directive("scrollWorkspace",["workspaceScrollModel",t])}(angular),function(e){"use strict";function t(){function e(e,t,r){}return{scope:{},link:e,restrict:"E",replace:!0,controller:"WorkspacesCtrl as workspaces",templateUrl:"realpage/workspaces/templates/workspaces.html"}}e.module("rpWorkspaces").directive("rpWorkspaces",[t])}(angular);
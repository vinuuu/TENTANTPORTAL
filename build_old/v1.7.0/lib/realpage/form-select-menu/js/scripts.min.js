angular.module("rpFormSelectMenu",[]),function(e){"use strict";function n(e){return function(){var n,t=[],r={},o=[],s="value",a="name";return r.change=e(),n={options:[],selected:"",labelText:"",updateLabel:!0},n.setNameKey=function(e){return a=n.nameKey=e,n},n.setValKey=function(e){return s=n.valKey=e,n},n.reset=function(){n.resetValue().resetState(),n.selected=n.options[0]},n.resetState=function(){for(var e in n.state)n.state[e]=!1},n.isValidOption=function(e){return void 0!==e[a]&&void 0!==e[s]},n.isDuplicateOption=function(e){var n=t.contains(e[a]),r=o.contains(e[s]);return n||r},n.setOptions=function(e){return e&&e.forEach&&e.forEach(n.addOption),n},n.addOption=function(e){return n.isValidOption(e)&&!n.isDuplicateOption(e)&&(n.options.push(e),t.push(e[a]),o.push(e[s]),1==n.options.length&&(n.selected=n.options[0])),n},n.removeOption=function(e){var r=t.indexOf(e[a]);return-1!=r&&(t.remove(r),o.remove(r),n.options.remove(r),0===r&&(n.selected=n.options[0])),n},n.flushOptions=function(){return t.flush(),o.flush(),n.selected="",n.options.flush(),n},n.selectOption=function(e){var r=t.indexOf(e[a]),u=o.indexOf(e[s]);return-1!=r?n.selected=n.options[r]:-1!=u&&(n.selected=n.options[u]),n},n.selectOptionIndex=function(e){return e<n.options.length&&e>-1&&(n.selected=n.options[e]),n},n.resetValue=function(){return n.form&&n.formKey&&(n.form[n.formKey]=""),n},n.updateValue=function(e){n.form&&n.formKey&&(n.form[n.formKey]=e[s])},n.destroy=function(){t=null,o=null},function(){n.events=r,n.valKey=s,n.nameKey=a,r.change.subscribe(n.updateValue)}(),n}}e.module("rpFormSelectMenu").factory("rpSelectMenuModel",["eventStream",n])}(angular),function(e){"use strict";function n(){var n={};return n.wrap=function(){return e.element("<div class='rp-select-menu'></div>")},n.inner=function(n){var t="<div class='rp-select-menu-inner' ng-class='"+n+".getState()'><span class='rp-select-menu-value'>{{"+n+".getDisplayText()}}</span><span ng-if='"+n+".errorMsg.required' class='error-msg required'>{{"+n+".errorMsg.required}}</span><span ng-if='"+n+".errorMsg.min' class='error-msg min'>{{"+n+".errorMsg.min}}</span><span ng-if='"+n+".errorMsg.max' class='error-msg max'>{{"+n+".errorMsg.max}}</span><span ng-if='"+n+".errorMsg.pattern' class='error-msg pattern'>{{"+n+".errorMsg.pattern}}</span></div>";return e.element(t)},n}e.module("rpFormSelectMenu").factory("rpSelectMenuHtml",[n])}(angular),function(e,n){"use strict";function t(t,r,o){function s(s,u,i,c){var l,p,f,d,m,g,v={},y={},M="blur.rpFormSelect"+ ++a,S="focus.rpFormSelect"+a;v.setInstanceName=function(){return g=i.rpInstanceName?i.rpInstanceName:"rpFormSelect"+a,v},v.exposeInstance=function(){return v.setInstanceName(),s[g]=v,v},v.decorate=function(){var e=o.wrap(),n=o.inner(g);return i.rpWrapperClass&&e.addClass(i.rpWrapperClass),r(e)(s),r(n)(s),l=u.wrap(e).parent().append(n),v},v.bindEvents=function(){return u.on(S,v.onFocus),v},v.storeData=function(){return p=v.getValue(),f=v.getSelectedName(),v},v.onFocus=function(){s.$apply(function(){y.focus=!0,l.addClass("focus"),u.on(M,v.onBlur)})},v.onBlur=function(){s.$apply(function(){u.off(M),y.focus=!1,l.removeClass("focus"),y.touched||(y.touched=!0)})},v.reset=function(){var e=t(i.ngModel);s.$apply(function(){v.state=y={},e.assign(s,p)})},v.getOptions=function(){return s.$eval(i.rpSelectOptions)},v.getValue=function(){return s.$eval(i.ngModel)},v.getState=function(){return c&&e.extend(y,{error:c.$invalid,touched:c.$touched,required:c.$required}),y},v.getDisplayText=function(){return s.$eval(i.rpUpdateDisplayText)?v.getSelectedName():f},v.getSelectedName=function(){var e,t=v.getValue(),r=v.getOptions().options;return t=t===n?"":t,r.forEach(function(n){t===n[m]&&(e=n[d])}),e},function(){v.state=y,d=i.rpOptionNameKey||"name",v.errorMsg=s.$eval(i.rpErrorMsg),m=i.rpOptionValueKey||"value",v.exposeInstance().decorate().bindEvents().storeData()}()}var a=0;return{link:s,restrict:"C",require:"ngModel"}}e.module("rpFormSelectMenu").directive("rpFormSelect",["$parse","$compile","rpSelectMenuHtml",t])}(angular);